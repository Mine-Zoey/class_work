# 网络传输协议

通信协议或简称为传输协议（Communications Protocol）在电信中，是指在任何物理介质中允许两个或多个在传输系统中的终端之间传播信息的系统标准，也是指计算机通信或网络设备的共同语言。通信协议定义了通信中的语法, 语义和同步规则以及可能存在的错误检测与纠正。常见的有以下几种：

- HTTP 协议，访问的是远程的网络资源，网络开发中最常用的协议。
- mailto 协议，访问的是电子邮件地址。
- FTP 协议，访问的是共享主机的文件资源。

# TCP/IP 协议簇

为了方便我们学习和理解 HTTP 协议，这里先介绍 TCP/IP 协议簇。通常意义上，我们使用的网络服务是在 TCP/IP 协议簇的基础上运作的，而 HTTP 协议属于它内部的一个子集。

其提供点对点的链接机制，将数据应该如何封装、定址、传输、路由以及在目的地如何接收，都加以标准化。它将软件通信进程抽象化为四个抽象层，采取协议堆栈的方式，分别实现出不同通信协议。协议族下的各种协议，依其功能不同，被分别归属到这四个层次结构之中，常被视为是简化的七层 OSI 模型。

![OSI 模型](img/OSI模型.png)
![数据封装递减](img/数据封装与递减.png)

# HTTP 协议

## 概述

HTTP 的全称是 Hypertext Transfer Protocol，即超文本传输协议 。客户端在访问网络资源的时候，经常需要用到 HTTP 协议。比如访问公司的主页，获取网易新闻数据，获取优酷的视频数据等都需要用到 HTTP 协议。

![HTTP协议请求与响应](img/HTTP协议请求与响应.png)

## HTTP 协议的作用

- 规定客户端和服务器之间的数据传输格式；
- 让客户端和服务器能有效地进行数据沟通。

## HTTP 协议的特点

- 简单快速，因为 HTTP 协议简单，所以 HTTP 服务器的程序规模小，而且通信速度很快。
- 方便灵活，HTTP 协议允许传输各种各样的数据，视频、音频、文本、图片等。
- 明文传输，HTTP 协议在进行请求和响应的时候数据以明文方式传输。
- HTTP 协议是无状态的：同一个客户端的这次请求和上次请求是没有对应关系，对 HTTP 服务器来说，它并不知道这两个请求来自同一个客户端。

## 版本历史

### HTTP 协议 0.9 版本

HTTP 协议 0.9 版本于 1990 年问世，那时的 HTTP 并没有作为正式的标准被建立。1991 年 Tim Berners-Lee 概述了该协议的动机，并罗列了几条宏观的涉及目标，如支持文件传输，能够请求对超文本文档的索引搜索，格式化协商机制以及能够把客户端引导至不同的服务器等，他构建了简单原型并实现了部分功能。因为最终的成品只实现了部分预期的功能，因此相应的协议也被非官方的成为 HTTP 0.9。以 1991 年为起点，HTTP 协议在随后的几年中得到了快速的发展。
主要功能和特点：
- 客户端|服务端，请求|响应协议；
- ASCII 协议，运行于 TCP/IP 链接之上；
- 涉及用来传输超文本文档（HTML）；
- 服务器和客户端之间的连接在每次请求之后都会关闭。

### HTTP 协议 1.0 版本

1996 年，HTTP 工作组发布了 RFC 1945，解释和说明了当时很多 HTTP 1.0 实现的公共用法。不过，该 RFC 是参考性的，也就是说 HTTP 1.0 并不是一个正式的规范或者是互联网标准。RFC 1945 - Hypertext Transfer Protocol — HTTP/1.0 http://www.ietf.org/rfc/rfc1945.txt HTTP 协议 1.0 版本后，服务器的响应对象不再局限与超文本而可以是任意类型：如 HTML 文件、纯文本文件，图片等。
HTTP 1.0 协议的关键变化：
- 请求可以由多行首部组成；
- 响应对象前面添加了响应状态行；
- 响应对象也拥有了自己的首部字段；
- 响应对象不再局限于超文本；
- 服务器与客户端之间的连接在每次请求之后都会关闭。

### HTTP 协议 1.1 版本

1997 年 1 月，定义了 HTTP 协议 1.1 版本 标准的 RFC 2068 发布。在 1999 年 6 月 RFC 2626 发布, 又在标准中集合了很多的更新和改进。HTTP/1.1 标准厘清了之前版本中很多有歧义的地方，且加入了很多重要的性能优化：如持久连接，分块编码传输，字节范围请求，增强的缓存机制，传输编码以及请求管道等。RFC 2616 - Hypertext Transfer Protocol — HTTP/1.1http://www.ietf.org/rfc/rfc2616.txt。
HTTP/1.1 最关键的变化在于改变了 HTTP 协议的语义，默认使用持久连接，该版本是目前广泛使用的版本。

### HTTP 协议 2.0 版本

RFC2626 自发布以来，一直都是互联网大发展的基石。从最开始的 HTTP 0.9 到今天，HTTP 已经发展成为可以在任何领域使用的核心协议。今天，用户和开发者都迫切想通过 HTTP 协议来实现几乎实时的响应速度和传输性能，而要满足这样的需求仅仅对既有的 HTTP 1.1 协议进行修补和更新是不够的。 因此，HTTP 工作组于 2012 年宣布开发 HTTP 2.0。HTTP 2.0 版本的开发保证了与 HTTP 1.1 的完全语义兼容，最初考虑的是 Google SPDY 协议、微软的 SM 协议和 Network-Friendly HTTP 更新。最终各方推荐了 SPDY 协议，并在此基础上进行了相应更新。对于 HTTP 2.0 而言，其主要目标是改进传输性能，实现低延迟和高吞吐量。官方设置的重要里程碑：
- 2012 年 3 月：征集 HTTP 2.0 建议;
- 2012 年 9 月：HTTP 2.0 的第一个草案发布;
- 2013 年 7 月：HTTP 2.0 草案的第一个实现发布;
- 2014 年 4 月：工作组最后征集 HTTP 2.0 的意见;
- 2014 年 11 月：将 HTTP 2.0 作为建议标准提交给 IESG。
- 2015 年底多数主流浏览器已经支持了该协议。

HTTP 2.0 协议的关键变化：
- 请求优先级；
- 服务器推送；
- 首部压缩；
- 二进制分帧层
- 多向请求和响应。

[HTTP 2.0 最新草案和状态，请参考](https://tools.ietf.org/html/draft-ietf-httpbis-http2-17)
[HTTP 2.0 中文版本，请参考](http://www.oschina.net/question/1397765_172789)